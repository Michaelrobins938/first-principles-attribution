%% Attribution Diagrams - Mermaid Templates
%% Replace placeholder values with actual IR data

%% ═══════════════════════════════════════════════════════════════════════════
%% 1) FLOW DIAGRAM - Top Transitions
%% ═══════════════════════════════════════════════════════════════════════════

flowchart LR
    subgraph Journey Flow
        START -->|0.52| Search
        Search -->|0.31| Email
        Email -->|0.44| Direct
        Direct -->|0.78| CONVERSION
        Search -->|0.18| NULL
        Social -->|0.25| Search
        Affiliate -->|0.35| Direct
    end
    
    style START fill:#6366f1,color:#fff
    style CONVERSION fill:#10b981,color:#fff
    style NULL fill:#ef4444,color:#fff


%% ═══════════════════════════════════════════════════════════════════════════
%% 2) ATTRIBUTION DECOMPOSITION
%% ═══════════════════════════════════════════════════════════════════════════

graph TD
    A[Total Conversion Value<br/>$150] --> B[Markov Attribution]
    A --> C[Shapley Attribution]
    
    B --> D{Hybrid Blend<br/>α = 0.5}
    C --> D
    
    D --> E[Search: $56.25]
    D --> F[Direct: $39.75]
    D --> G[Email: $33.75]
    D --> H[Others: $20.25]
    
    style A fill:#6366f1,color:#fff
    style B fill:#ec4899,color:#fff
    style C fill:#8b5cf6,color:#fff
    style D fill:#14b8a6,color:#fff


%% ═══════════════════════════════════════════════════════════════════════════
%% 3) PSYCHOGRAPHIC INFLUENCE MAP
%% ═══════════════════════════════════════════════════════════════════════════

flowchart TB
    subgraph Inputs
        W[Psychographic Weights<br/>high_intent: 1.5x<br/>low_intent: 0.7x]
        E[Event Paths]
    end
    
    subgraph Processing
        W --> TC[Weighted Transition Counts]
        E --> TC
        TC --> T[Transition Matrix T<br/>Row-stochastic]
    end
    
    subgraph Markov Branch
        T --> Q[Extract Q, R]
        Q --> N[N = I-Q⁻¹]
        N --> B[B = NR]
        B --> RE[Removal Effects]
        RE --> MS[Markov Share]
    end
    
    subgraph Shapley Branch
        T --> V[v S via Markov]
        V --> SH[Shapley Formula]
        SH --> SS[Shapley Share]
    end
    
    subgraph Output
        MS --> H{Hybrid<br/>α blend}
        SS --> H
        H --> OUT[Final Attribution]
    end
    
    style W fill:#f59e0b,color:#000
    style T fill:#6366f1,color:#fff
    style H fill:#14b8a6,color:#fff
    style OUT fill:#10b981,color:#fff


%% ═══════════════════════════════════════════════════════════════════════════
%% 4) CHANNEL COMPARISON (Optional)
%% ═══════════════════════════════════════════════════════════════════════════

graph LR
    subgraph Markov Share
        M_Search[Search: 40%]
        M_Direct[Direct: 25%]
        M_Email[Email: 20%]
        M_Other[Other: 15%]
    end
    
    subgraph Shapley Share
        S_Search[Search: 35%]
        S_Direct[Direct: 28%]
        S_Email[Email: 22%]
        S_Other[Other: 15%]
    end
    
    subgraph Hybrid Share
        H_Search[Search: 37.5%]
        H_Direct[Direct: 26.5%]
        H_Email[Email: 21%]
        H_Other[Other: 15%]
    end
